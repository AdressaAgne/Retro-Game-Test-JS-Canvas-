"use strict";function changeBlock(e,t,i){e.block_id=t,resetAnimation(e),"function"==typeof i&&i.bind(e)()}function changeOnUse(e,t,i,n,s){e.block_id==t&&(Engine.changeInvetoryItem(n),e.block_id=i,resetAnimation(e),"function"==typeof s&&s.bind(e)())}function removeOnUse(e,t,i){e.block_id==t&&(Engine.removeSelectedInvetoryitem(),e.block_id=i,resetAnimation(e))}function resetAnimation(e){e.animCount=0}function addItem(e,t){MapObjects[e]=t}function onAction(e,t,i){i===Engine.facing&&"function"==typeof Engine.fullMap[e][t].block_id.onAction&&(Engine.fullMap[e][t].block_id.onAction.bind(Engine.fullMap[e][t])(),Engine.fullMap[e][t].isSearched=!0)}function onUse(e,t,i){if(i===Engine.facing&&0!=Engine.invetory.length&&"undefined"!=typeof Engine.invetory[Engine.selectedInvetorySlot]&&"undefined"!=typeof MapObjects[Engine.invetory[Engine.selectedInvetorySlot].uuid].onUse){var n=Engine.invetory[Engine.selectedInvetorySlot].uuid;MapObjects[n].onUse.bind(Engine.fullMap[e][t])()}}function updatePosition(e,t,i){"function"==typeof Engine.fullMap[e][t].block_id.onWalkOver&&i?Engine.fullMap[e][t].block_id.onWalkOver.bind(Engine.fullMap[e][t])():"function"!=typeof Engine.fullMap[e][t].block_id.onSolidHit||i||Engine.fullMap[e][t].block_id.onSolidHit.bind(Engine.fullMap[e][t])()}function componentToHex(e){var t=e.toString(16);return 1==t.length?"0"+t:t}function rgbToHex(e,t,i){return componentToHex(e)+componentToHex(t)+componentToHex(i)}function baseName(e){var t=new String(e).substring(e.lastIndexOf("/")+1);return-1!=t.lastIndexOf(".")&&(t=t.substring(0,t.lastIndexOf("."))),t}function rng(e,t){return Math.floor(Math.random()*(t-e+1)+e)}function animate(){if(Engine.allowRender&&requestAnimFrame(animate),Engine.ImageSmoothing(!1),Engine.renderMenu)return pressedKeys[keyCodes.w]&&Engine.menu.selectedButton>0&&(Engine.menu.selectedButton--,pressedKeys[keyCodes.w]=!1),pressedKeys[keyCodes.s]&&Engine.menu.selectedButton<Engine.menu.buttons.length-1&&(Engine.menu.selectedButton++,pressedKeys[keyCodes.s]=!1),pressedKeys[keyCodes.enter]&&(Engine.menu.buttons[Engine.menu.selectedButton].press(),pressedKeys[keyCodes.enter]=!1),void Engine.RenderMenu();var e=Engine.fullMap,t=Engine.GetPlayerCords(),i=t.x,n=t.y;if(Engine.walk(keyCodes.w,1,Engine.walkingDist),Engine.walk(keyCodes.s,3,Engine.walkingDist),Engine.walk(keyCodes.a,0,Engine.walkingDist),Engine.walk(keyCodes.d,2,Engine.walkingDist),!(pressedKeys[keyCodes.w]||pressedKeys[keyCodes.s]||pressedKeys[keyCodes.a]||pressedKeys[keyCodes.d]),pressedKeys[keyCodes.e]){onAction(i,n-1,1),onAction(i,n+1,3),onAction(i+1,n,2),onAction(i-1,n,0),pressedKeys[keyCodes.e]=!1;var s=Engine.fullMap[i][n];"function"==typeof s.block_id.onActionOver&&s.block_id.onActionOver.bind(s)(),"function"==typeof s.block_id.onUseOver&&s.block_id.onUseOver.bind(s)(),"undefiend"!=typeof s.block_id.canPickUp&&s.block_id.canPickUp&&Engine.addToInvetory(s.block_id)&&(s.block_id=ItemsList.dirt)}pressedKeys[keyCodes.q]&&(onUse(i,n-1,1),onUse(i,n+1,3),onUse(i+1,n,2),onUse(i-1,n,0),pressedKeys[keyCodes.q]=!1),pressedKeys[keyCodes.n0]&&(Engine.selectedInvetorySlot=9);for(var o=0;10>o;o++)pressedKeys[keyCodes["n"+(o+1)]]&&(Engine.selectedInvetorySlot=o);pressedKeys[keyCodes.o]&&(Engine.debug.showPlayerBox=!Engine.debug.showPlayerBox,pressedKeys[keyCodes.o]=!1),pressedKeys[keyCodes.i]&&(Engine.debug.showPlayerCords=!Engine.debug.showPlayerCords,pressedKeys[keyCodes.i]=!1),Engine.Render();var a=(Date.now()-timeFPS)/1e3;timeFPS=Date.now(),fps=1/a,drawFPS&&Engine.drawFPS(fps)}function isInt(e){return Number(e)===e&&e%0===0}var MapObjects={};addItem("000000",{name:"wall",solid:!0,moveable:!1,alternative3D:function(){return[ItemsList.wall_edge]},type:"block",x:1,y:0}),addItem("484848",{name:"wall_edge",solid:!0,moveable:!1,type:"block",x:2,y:0}),addItem("3c3c3c",{name:"wall_below_edge",solid:!0,moveable:!1,type:"block",x:6,y:0}),addItem("776022",{name:"door",solid:!1,moveable:!1,type:"block",x:3,y:0}),addItem("ffffff",{name:"dirt",solid:!1,moveable:!1,type:"block",x:0,y:0}),addItem("00ff00",{name:"chest",solid:!1,moveable:!0,type:"item",x:0,y:9,onWalkOver:function(){Engine.loadNextMap("next")}}),addItem("ff0000",{name:"player",solid:!1,moveable:!1,type:"player",facing:[[{x:0,y:8},{x:1,y:8},{x:2,y:8}],[{x:0,y:6},{x:1,y:6},{x:2,y:6}],[{x:0,y:7},{x:1,y:7},{x:2,y:7}],[{x:0,y:5},{x:1,y:5},{x:2,y:5}]]}),addItem("00a000",{name:"hedge",solid:!0,moveable:!1,alternative3D:function(){return[ItemsList.hedge_edge,ItemsList.rose_hedge_edge]},type:"block",x:1,y:1}),addItem("009100",{name:"hedge_edge",solid:!0,moveable:!1,type:"block",x:2,y:1}),addItem("d500ff",{name:"rose_hedge_edge",solid:!0,moveable:!1,type:"block",x:4,y:1}),addItem("004f00",{name:"hedge_edge_door",solid:!1,moveable:!1,type:"block",x:3,y:1}),addItem("88293b",{name:"ruby",solid:!1,moveable:!1,type:"item",x:6,y:10,onWalkOver:function(){Engine.money+=25,changeBlock(this,ItemsList.dirt)}}),addItem("f9e000",{name:"gold_coin",solid:!1,moveable:!1,type:"item",anim:[{x:3,y:10},{x:3,y:11},{x:3,y:12},{x:3,y:13},{x:3,y:12},{x:3,y:11}],onWalkOver:function(){Engine.money+=10,changeBlock(this,ItemsList.dirt)}}),addItem("e5e5e5",{name:"silver_coin",solid:!1,moveable:!1,type:"item",anim:[{x:4,y:10},{x:4,y:11},{x:4,y:12},{x:4,y:13},{x:4,y:12},{x:4,y:11}],onWalkOver:function(){Engine.money+=5,changeBlock(this,ItemsList.dirt)}}),addItem("cd6e28",{name:"bronze_coin",solid:!1,moveable:!1,type:"item",onWalkOver:function(){Engine.money++,changeBlock(this,ItemsList.dirt)},anim:[{x:5,y:10},{x:5,y:11},{x:5,y:12},{x:5,y:13},{x:5,y:12},{x:5,y:11}]}),addItem("cd3f28",{name:"fire",solid:!0,moveable:!1,type:"item",anim:[{x:0,y:15},{x:1,y:15},{x:2,y:15}],onWalkOver:function(){console.log("au")}}),addItem("d13131",{name:"hp",solid:!1,moveable:!1,type:"item",x:0,y:11,onWalkOver:function(){console.log("au")}}),addItem("bada55",{name:"water_fall",solid:!0,moveable:!1,alternative3D:function(){return[ItemsList.water_fall_end]},type:"block",anim:[{x:14,y:0},{x:14,y:1}]}),addItem("98b244",{name:"water_fall_end",solid:!0,moveable:!1,type:"block",anim:[{x:15,y:0},{x:15,y:1}],onRender:function(){Engine.fullMap[this.x][this.y+1].block_id==ItemsList.dirt&&(Engine.fullMap[this.x][this.y+1].block_id=MapObjects[667731])}}),addItem("667731",{name:"water",solid:!0,moveable:!1,type:"block",anim:[{x:1,y:2},{x:2,y:2},{x:3,y:2},{x:4,y:2},{x:5,y:2}]}),addItem("ff6600",{name:"lava",solid:!0,moveable:!1,type:"block",anim:[{x:1,y:3},{x:2,y:3},{x:3,y:3},{x:4,y:3},{x:5,y:3}]}),addItem("lava_steam",{name:"lava_steam",solid:!0,moveable:!1,type:"block",anim:[{x:9,y:3},{x:10,y:3},{x:11,y:3}],onRender:function(){0==this.animCount&&changeBlock(this,ItemsList.lava)}}),addItem("steam",{name:"steam",solid:!1,moveable:!1,type:"item",anim:[{x:9,y:2},{x:10,y:2},{x:11,y:2}],onRender:function(){0==this.animCount&&changeBlock(this,ItemsList.dirt)}}),addItem("2f91a6",{name:"Bucket",solid:!1,moveable:!1,type:"item",x:3,y:6,canPickUp:!0,onUse:function(){changeOnUse(this,ItemsList.water,ItemsList.dirt,ItemsList.bucket_filled_water),changeOnUse(this,ItemsList.swomp,ItemsList.dirt,ItemsList.bucket_filled_swomp),removeOnUse(this,ItemsList.lava,ItemsList.fire),changeOnUse(this,ItemsList.swomp_2,ItemsList.dirt,ItemsList.bucket_filled_swomp),changeOnUse(this,ItemsList.swomp_3,ItemsList.dirt,ItemsList.bucket_filled_swomp)}}),addItem("19454d",{name:"Bucket_Filled_Swomp",solid:!1,moveable:!1,type:"item",x:6,y:6,canPickUp:!0,onUse:function(){changeOnUse(this,ItemsList.dirt,ItemsList.swomp_2,ItemsList.bucket),changeOnUse(this,ItemsList.fire,ItemsList.dirt,ItemsList.bucket),changeOnUse(this,ItemsList.lava,ItemsList.dirt,ItemsList.bucket)}}),addItem("7d9ca2",{name:"Iron_Bucket",solid:!1,moveable:!1,type:"item",x:3,y:5,canPickUp:!0,onUse:function(){changeOnUse(this,ItemsList.water,ItemsList.dirt,ItemsList.iron_bucket_water),changeOnUse(this,ItemsList.lava,ItemsList.dirt,ItemsList.iron_bucket_lava),changeOnUse(this,ItemsList.swomp,ItemsList.dirt,ItemsList.iron_bucket_swomp),changeOnUse(this,ItemsList.swomp_2,ItemsList.dirt,ItemsList.iron_bucket_swomp),changeOnUse(this,ItemsList.swomp_3,ItemsList.dirt,ItemsList.iron_bucket_swomp)}}),addItem("6a868b",{name:"Iron_Bucket_Water",solid:!1,moveable:!1,type:"item",x:5,y:5,canPickUp:!0,onUse:function(){changeOnUse(this,ItemsList.dirt,ItemsList.water,ItemsList.iron_bucket),changeOnUse(this,ItemsList.fire,ItemsList.steam,ItemsList.iron_bucket),changeOnUse(this,ItemsList.lava,ItemsList.lava_steam,ItemsList.iron_bucket)}}),addItem("556b6f",{name:"Iron_Bucket_Lava",solid:!1,moveable:!1,type:"item",x:4,y:5,canPickUp:!0,onUse:function(){changeOnUse(this,ItemsList.dirt,ItemsList.lava,ItemsList.iron_bucket),changeOnUse(this,ItemsList.swomp,ItemsList.dirt,ItemsList.iron_bucket),changeOnUse(this,ItemsList.water,ItemsList.dirt,ItemsList.iron_bucket)}}),addItem("3e4f52",{name:"Iron_Bucket_Swomp",solid:!1,moveable:!1,type:"item",x:6,y:5,canPickUp:!0,onUse:function(){changeOnUse(this,ItemsList.dirt,ItemsList.swomp_2,ItemsList.iron_bucket),changeOnUse(this,ItemsList.fire,ItemsList.steam,ItemsList.iron_bucket),changeOnUse(this,ItemsList.lava,ItemsList.dirt,ItemsList.iron_bucket)}}),addItem("256d7c",{name:"Bucket_Filled_Water",solid:!1,moveable:!1,type:"item",x:5,y:6,canPickUp:!0,onUse:function(){changeOnUse(this,ItemsList.dirt,ItemsList.water,ItemsList.bucket),changeOnUse(this,ItemsList.fire,ItemsList.steam,ItemsList.bucket),changeOnUse(this,ItemsList.lava,ItemsList.lava_steam,ItemsList.bucket)}}),addItem("1e5661",{name:"Bucket Filled Lava",solid:!1,moveable:!1,type:"item",x:4,y:6,canPickUp:!0,onUse:function(){changeOnUse(this,ItemsList.water,ItemsList.dirt,ItemsList.bucket),changeOnUse(this,ItemsList.dirt,ItemsList.lava,ItemsList.bucket)}}),addItem("eddfae",{name:"Key",solid:!1,moveable:!1,type:"item",x:6,y:9,canPickUp:!0,onUse:function(){removeOnUse(this,ItemsList.door_closed,ItemsList.door_open)}}),addItem("745208",{name:"Door_Open",solid:!1,moveable:!1,type:"item",x:1,y:4}),addItem("513906",{name:"Door_Closed",solid:!0,moveable:!1,type:"item",x:0,y:4}),addItem("bb9983",{name:"lever_off",solid:!0,moveable:!1,type:"item",x:2,y:4,onAction:function(){if(changeBlock(this,ItemsList.lever_on),Engine.doors.hasPower){for(var e=0;e<Engine.doors.doors.length;e++){var t=Engine.doors.doors[e];Engine.fullMap[t.x][t.y].block_id=ItemsList.iron_door_closed}changeBlock(Engine.fullMap[Engine.doors.doors[Engine.doors.selectedDoor].x][Engine.doors.doors[Engine.doors.selectedDoor].y],ItemsList.iron_door_open)}}}),addItem("lever_on",{name:"lever_on",solid:!0,moveable:!1,type:"item",x:3,y:4,onAction:function(){if(changeBlock(this,ItemsList.lever_off),Engine.doors.hasPower)for(var e=0;e<Engine.doors.doors.length;e++){var t=Engine.doors.doors[e];changeBlock(Engine.fullMap[t.x][t.y],ItemsList.iron_door_closed)}}}),addItem("panel_off",{name:"panel_off",solid:!0,moveable:!1,type:"block",x:10,y:0,onRender:function(){Engine.fullMap[this.x+1][this.y].block_id.isPowerSource&&(changeBlock(this,ItemsList.panel_1),Engine.doors.hasPower=!0,Engine.doors.selectedDoor=0)}}),addItem("05eb76",{name:"panel_1",solid:!0,moveable:!1,type:"block",x:11,y:0,onAction:function(){Engine.fullMap[this.x+1][this.y].block_id.isPowerSource&&(changeBlock(this,ItemsList.panel_2),Engine.doors.selectedDoor=1)},onRender:function(){Engine.fullMap[this.x+1][this.y].block_id.isPowerSource||(changeBlock(this,ItemsList.panel_off),Engine.doors.hasPower=!1)}}),addItem("panel_2",{name:"panel_2",solid:!0,moveable:!1,type:"block",x:12,y:0,onAction:function(){Engine.fullMap[this.x+1][this.y].block_id.isPowerSource&&(changeBlock(this,ItemsList.panel_3),Engine.doors.selectedDoor=2)},onRender:function(){Engine.fullMap[this.x+1][this.y].block_id.isPowerSource||(changeBlock(this,ItemsList.panel_off),Engine.doors.hasPower=!1)}}),addItem("panel_3",{name:"panel_3",solid:!0,moveable:!1,type:"block",x:13,y:0,onAction:function(){Engine.fullMap[this.x+1][this.y].block_id.isPowerSource&&(changeBlock(this,ItemsList.panel_1),Engine.doors.selectedDoor=0)},onRender:function(){Engine.fullMap[this.x+1][this.y].block_id.isPowerSource||(changeBlock(this,ItemsList.panel_off),Engine.doors.hasPower=!1)}}),addItem("f0ca18",{name:"battery",solid:!1,moveable:!1,type:"item",isPowerSource:!0,x:11,y:1,canPickUp:!0,onUse:function(){this.block_id==ItemsList.dirt&&(Engine.removeSelectedInvetoryitem(),changeBlock(this,ItemsList.battery))}}),addItem("2d2d2d",{name:"iron_door_closed",solid:!0,moveable:!1,type:"block",x:12,y:1}),addItem("iron_door_open",{name:"iron_door_open",solid:!1,moveable:!1,type:"block",x:13,y:1}),addItem("232e1d",{name:"Snake",drop:function(){return ItemsList.key},solid:!0,moveable:!1,type:"creature",anim:[{x:7,y:8},{x:7,y:8},{x:7,y:8},{x:6,y:8},{x:5,y:8},{x:6,y:8},{x:7,y:8},{x:7,y:8},{x:7,y:8}],onRenderFull:function(){"undefined"==typeof this.hp&&(this.hp=5),Engine.drawFromSprite(MapObjects.healthBar.anim[5-this.hp],this.x,this.y)}}),addItem("808080",{name:"Boulder",solid:!0,moveable:!1,type:"item",x:1,y:10,onSolidHit:function(){var e=this.x,t=this.y,i=Engine.facing;0==i&&--e,1==i&&--t,2==i&&++e,3==i&&++t,Engine.fullMap[e][t].block_id==ItemsList.dirt&&(Engine.fullMap[e][t].block_id=this.block_id,this.block_id=ItemsList.dirt),Engine.fullMap[e][t].block_id==ItemsList.water&&(Engine.fullMap[e][t].block_id=ItemsList.dirt,this.block_id=ItemsList.dirt)}}),addItem("healthBar",{name:"Health_Bar",solid:!1,moveable:!1,type:"item",anim:[{x:5,y:7},{x:6,y:7},{x:7,y:7},{x:8,y:7},{x:9,y:7}]}),addItem("b60808",{name:"Mushroom",solid:!0,moveable:!1,type:"item",x:7,y:9,onUse:function(){Engine.removeSelectedInvetoryitem()}}),addItem("464268",{name:"Bat",solid:!0,moveable:!1,type:"creature",drop:function(){return[ItemsList.gold_coin,ItemsList.silver_coin,ItemsList.bronze_coin]},anim:[{x:8,y:8},{x:9,y:8},{x:10,y:8},{x:11,y:8},{x:12,y:8},{x:11,y:8},{x:10,y:8},{x:9,y:8}],onRender:function(){0==this.animCount&&Engine.moveRngBlock(this)},onRenderFull:function(){"undefined"==typeof this.hp&&(this.hp=5),Engine.drawFromSprite(MapObjects.healthBar.anim[5-this.hp],this.x,this.y)}}),addItem("a048dd",{name:"Dagger",solid:!1,moveable:!1,type:"item",x:3,y:9,canPickUp:!0,onUse:function(){if("creature"==this.block_id.type&&(this.hp--,this.hp<=0)){var e=this.block_id.drop();changeBlock(this,e[rng(0,e.length-1)]),resetAnimation(this.block_id)}this.block_id==ItemsList.mushroom&&Engine.addToInvetory(this.block_id)&&(this.block_id=ItemsList.dirt)}}),addItem("7d5112",{name:"swomp",solid:!1,moveable:!1,type:"block",alternative:function(){return[ItemsList.swomp_2,ItemsList.swomp_3]},anim:[{x:6,y:2},{x:7,y:2},{x:8,y:2},{x:7,y:2}]}),addItem("swomp2",{name:"swomp_2",solid:!1,moveable:!1,type:"block",anim:[{x:6,y:3},{x:7,y:3},{x:8,y:3},{x:7,y:3}]}),addItem("swomp",{name:"swomp_3",solid:!1,moveable:!1,type:"block",anim:[{x:6,y:4},{x:7,y:4},{x:8,y:4},{x:7,y:4}]}),addItem("test",{name:"test",solid:!1,moveable:!1,type:"block",x:11,y:15}),addItem("ecc40b",{name:"touch",solid:!1,moveable:!1,type:"item",canPickUp:!0,anim:[{x:7,y:10},{x:7,y:11},{x:7,y:12}],onUse:function(){changeOnUse(this,ItemsList.tnt,ItemsList.tnt_prime,ItemsList.touch)}}),addItem("boom",{name:"explotion",solid:!1,moveable:!1,type:"item",anim:[{x:9,y:4},{x:10,y:4},{x:11,y:4}],onRender:function(){0==this.animCount&&(this.block_id=ItemsList.dirt)}}),addItem("3c3e3f",{name:"belt_right",solid:!1,moveable:!1,type:"item",anim:[{x:10,y:15},{x:9,y:15},{x:8,y:15}],onRender:function(){this.x==Engine.GetPlayerCords().x&&this.y==Engine.GetPlayerCords().y&&Engine.walkDir(2,Engine.walkingDist)}}),addItem("2b3033",{name:"belt_left",solid:!1,moveable:!1,type:"item",anim:[{x:8,y:15},{x:9,y:15},{x:10,y:15}],onRender:function(){this.x==Engine.GetPlayerCords().x&&this.y==Engine.GetPlayerCords().y&&Engine.walkDir(0,Engine.walkingDist)}}),addItem("a3250c",{name:"tnt",solid:!1,moveable:!1,type:"item",canPickUp:!0,x:15,y:12,onUse:function(){removeOnUse(this,ItemsList.dirt,ItemsList.tnt)}}),addItem("tnt_prime",{name:"tnt_prime",solid:!1,moveable:!1,type:"item",anim:[{x:15,y:11},{x:14,y:11},{x:13,y:11},{x:12,y:11}],onRender:function(){0==this.animCount&&(this.block_id=ItemsList.explotion)}}),addItem("d0cbbe",{name:"collector_stage_1",solid:!0,moveable:!1,type:"item",x:11,y:14}),addItem("collector_stage_2",{name:"collector_stage_2",solid:!0,moveable:!1,type:"item",x:12,y:14}),addItem("collector_stage_3",{name:"collector_stage_3",solid:!0,moveable:!1,type:"item",x:13,y:14}),addItem("collector_stage_4",{name:"collector_stage_4",solid:!0,moveable:!1,type:"item",x:14,y:14}),addItem("collector_stage_5",{name:"collector_stage_5",solid:!0,moveable:!1,type:"item",anim:[{x:11,y:13},{x:12,y:13},{x:13,y:13},{x:14,y:13},{x:15,y:13},{x:14,y:13},{x:13,y:13},{x:12,y:13}]}),addItem("f5c009",{name:"gold_box",solid:!1,moveable:!1,type:"item",canPickUp:!0,x:0,y:12,onUse:function(){removeOnUse(this,ItemsList.dirt,ItemsList.gold_box),removeOnUse(this,ItemsList.collector_stage_4,ItemsList.collector_stage_5),removeOnUse(this,ItemsList.collector_stage_3,ItemsList.collector_stage_4),removeOnUse(this,ItemsList.collector_stage_2,ItemsList.collector_stage_3),removeOnUse(this,ItemsList.collector_stage_1,ItemsList.collector_stage_2)}}),addItem("boomerang_prime",{name:"boomerang_prime",solid:!0,moveable:!1,type:"item",anim:[{x:13,y:3},{x:13,y:4},{x:12,y:4},{x:12,y:3}],onRender:function(){setTimeout(function(){var e=this.x,t=this.y;if(0==this.dir&&--e,1==this.dir&&--t,2==this.dir&&++e,3==this.dir&&++t,Engine.fullMap[e][t].block_id==ItemsList.dirt)Engine.fullMap[e][t].block_id=ItemsList.boomerang_prime,Engine.fullMap[e][t].animCount=this.animCount,Engine.fullMap[e][t].dir=this.dir,Engine.fullMap[e][t].l=this.l,Engine.fullMap[e][t].l++,this.l>2&&(0==Engine.fullMap[e][t].dir?Engine.fullMap[e][t].dir=2:1==Engine.fullMap[e][t].dir?Engine.fullMap[e][t].dir=3:2==Engine.fullMap[e][t].dir?Engine.fullMap[e][t].dir=0:3==Engine.fullMap[e][t].dir&&(Engine.fullMap[e][t].dir=1),Engine.fullMap[e][t].l=0),changeBlock(this,ItemsList.dirt),e==Engine.GetPlayerCords().x&&t==Engine.GetPlayerCords().y&&(changeBlock(Engine.fullMap[e][t],ItemsList.dirt),Engine.addToInvetory(ItemsList.boomerang));else{if("creature"==Engine.fullMap[e][t].block_id.type&&(Engine.fullMap[e][t].hp--,Engine.fullMap[e][t].hp<=0)){var i=Engine.fullMap[e][t].block_id.drop();changeBlock(Engine.fullMap[e][t],i[rng(0,i.length-1)]),resetAnimation(Engine.fullMap[e][t].block_id)}changeBlock(this,ItemsList.boomerang)}delete this.dir,delete this.l}.bind(this),0)}}),addItem("825c2c",{name:"boomerang",solid:!1,moveable:!1,type:"item",canPickUp:!0,x:13,y:3,onUse:function(){"undefined"==typeof this.dir&&(this.dir=Engine.facing),"undefined"==typeof this.l&&(this.l=1),removeOnUse(this,ItemsList.dirt,ItemsList.boomerang_prime)}});var texture={sprite:"img/texture/textures.png",gui:"img/texture/gui.png",menu:"img/texture/background.png",map1:"img/maps/1.gif",map2:"img/maps/2.gif",map3:"img/maps/3.gif",map4:"img/maps/4.gif",testMap:"img/maps/auto.gif"},keyCodes={w:87,s:83,a:65,d:68,e:69,q:81,i:73,o:79,n0:48,n1:49,n2:50,n3:51,n4:52,n5:53,n6:54,n7:55,n8:56,n9:57,esc:27,enter:13,space:32,ArrowDown:40,ArrowRight:39,ArrowUp:38,ArrowLeft:37},pressedKeys={};document.addEventListener("keydown",function(e){pressedKeys[e.keyCode]=!0}),document.addEventListener("keyup",function(e){pressedKeys[e.keyCode]=!1});var timeFPS,fps,drawFPS=!0;window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){window.setTimeout(e,1e3/60)}}();var Engine={canvas:document.getElementById("game"),ctx:document.getElementById("game").getContext("2d"),allowRender:!0,CurrentMap:null,currentMapNr:0,fullMap:{},startMap:4,fog:4,facing:3,count:0,maxCount:10,debug:{showPlayerBox:!1,showPlayerCords:!1},invetory:[],money:0,selectedInvetorySlot:0,player:{animCount:0,x:0,y:0,isWalking:!1},walkingDist:.1,doors:{selectedDoor:0,doors:[],hasPower:!1},gui:{height:192,width:0},Items:{},renderMenu:!0,menu:{selectedButton:0,buttons:[{text:"Play Game",press:function(){Engine.renderMenu=!1}},{text:"How To Play",press:function(){Engine.renderHowToPlay=!0}},{text:"Credits",press:function(){Engine.renderCredits=!0}}]},Render:function(e){var t=this.CurrentMap;Engine.ctx.clearRect(0,0,64*this.CurrentMap.width,64*this.CurrentMap.height);for(var i in this.fullMap)if(this.fullMap.hasOwnProperty(i))for(var n in this.fullMap[i]){var s=this.fullMap[i][n];"undefined"==typeof s.block_id&&(console.log(s,s.block_id),this.allowRender=!1),"player"!=s.block_id.type&&"item"!=s.block_id.type&&"creature"!=s.block_id.type||this.drawFromSprite(MapObjects.ffffff,s.x,s.y),"undefined"!=typeof s.block_id.anim?("undefined"==typeof s.animCount&&(s.animCount=rng(0,s.block_id.anim.length-3)),this.drawFromAnimSprite(s.block_id.anim[s.animCount],s.x,s.y),0==this.count&&(++s.animCount,s.animCount>=s.block_id.anim.length&&(s.animCount=0))):(this.drawFromSprite(s.block_id,s.x,s.y),this.drawFromSprite(s.block_id,s.x,s.y)),"function"==typeof s.block_id.onRender&&0==this.count&&s.block_id.onRender.bind(s)(),"function"==typeof s.block_id.onRenderFull&&s.block_id.onRenderFull.bind(s)()}this.RenderPlayer(s),this.RenderFog(),this.RenderGUI(),this.count=this.count>=this.maxCount?0:this.count+1},ImageSmoothing:function(e){this.ctx.mozImageSmoothingEnabled=e,this.ctx.webkitImageSmoothingEnabled=e,this.ctx.msImageSmoothingEnabled=e,this.ctx.imageSmoothingEnabled=e},Open:function(e){this.allowRender=!1;var t=document.createElement("canvas"),i=t.getContext("2d");t.width=e.width,t.height=e.height,this.canvas.width=64*e.width+this.gui.width,this.canvas.height=64*e.height+this.gui.height,i.drawImage(e,0,0);for(var n={width:e.width,height:e.height},s=0;s<e.width;s++){this.fullMap[s]={};for(var o=0;o<e.height;o++){var a=i.getImageData(s,o,1,1).data,r=rgbToHex(a[0],a[1],a[2]),l={x:s,y:o,block_id:MapObjects[r],color:r};if("ff0000"==r){this.player.x=s,this.player.y=o;var l={x:s,y:o,block_id:MapObjects.ffffff,color:r}}this.fullMap[s][o]=l}}for(var s=0;s<e.width;s++)for(var o=0;o<e.height;o++){var d=this.fullMap[s][o];if("undefined"!=typeof d.block_id.alternative3D&&"undefined"!=typeof this.fullMap[s][o+1]&&(0!=this.fullMap[s][o+1].block_id.solid&&"water"!=this.fullMap[s][o+1].block_id.name&&"item"!=this.fullMap[s][o+1].block_id.type&&"lava"!=this.fullMap[s][o+1].block_id.name||(this.fullMap[s][o].block_id=d.block_id.alternative3D()[rng(0,d.block_id.alternative3D().length-1)])),"undefined"!=typeof d.block_id.alternative){var m=d.block_id.alternative();m.push(d.block_id),d.block_id=m[rng(0,m.length-1)]}d.block_id==ItemsList.iron_door_closed&&this.doors.doors.push(d)}return this.allowRender=!0,n},init:function(){this.canvas.width=1024,this.canvas.height=1024,this.drawLoading("Loading... 0%");var e=Object.keys(texture).length,t=0;for(var i in texture)if(texture.hasOwnProperty(i)){var n=texture[i];texture[i]=new Image,texture[i].src=n,texture[i].onload=function(i){t++,this.drawLoading("Loading... "+parseInt(t/e*100)+"% ("+i+")"),t===e&&(this.fog=Maps[this.startMap].fog,this.CurrentMap=this.Open(Maps[this.startMap].file),this.startGame())}.bind(this)}},startGame:function(){animate()}};Engine.RenderFog=function(){var e=this.CurrentMap.width,t=this.CurrentMap.height,i=this.player.x,n=this.player.y,s=this.fog/2;this.ctx.clearRect(0,0,64*(e-(e-i)-s),64*t),this.ctx.clearRect(0,0,64*e,64*(t-(t-n)-s)),this.ctx.clearRect(0,64*(t-(t-n-s-1)),64*e,64*t),this.ctx.clearRect(64*(e-(e-i-s-1)),0,64*e,64*t)},Engine.RenderGUI=function(){this.ctx.drawImage(texture.gui,0,0,256,48,0,1024,1024,192),this.drawFromSprite(this.RenderStill("cd6e28"),.5,16.5),this.drawFromSprite(MapObjects.d13131,this.CurrentMap.width-1.5,16.5),this.drawFromSprite(MapObjects.d13131,this.CurrentMap.width-2.5,16.5),this.drawFromSprite(MapObjects.d13131,this.CurrentMap.width-3.5,16.5),this.RenderText("#f8f8f8",this.money,1.5,17.15);for(var e=10,t=0;e>t;t++)this.ctx.drawImage(texture.gui,0,48,21,21,24+21*t*4+-4*t,1124,94,84);this.ctx.drawImage(texture.gui,21,48,23,23,19+92*this.selectedInvetorySlot+-11*this.selectedInvetorySlot,1120,92,92);for(var t=0;t<this.invetory.length;t++)this.drawToInventory(this.invetory[t],t)},Engine.RenderPlayer=function(){var e=this.GetPlayerCords();this.debug.showPlayerBox&&this.drawFromSprite(ItemsList.test,e.x,e.y),this.debug.showPlayerCords&&this.RenderText("#ffffff","X: "+e.x+"("+this.player.x.toFixed(1)+"), Y:"+e.y+"("+this.player.y.toFixed(1)+")",1,1),this.drawPlayer(this.player.x,this.player.y)},Engine.RenderStill=function(e){return"undefined"!=typeof MapObjects[e].anim[0]?MapObjects[e].anim[0]:MapObjects[e]},Engine.RenderText=function(e,t,i,n){this.ctx.fillStyle=e,this.ctx.font="34px Verdana",this.ctx.fillText(t,64*i,64*n)},Engine.RenderTextPixels=function(e,t,i,n){this.ctx.fillStyle=e,this.ctx.font="34px Verdana",this.ctx.fillText(t,i,n)},Engine.RenderRect=function(e,t,i,n,s){this.ctx.fillStyle=e,this.ctx.fillRect(t,i,n,s)},Engine.RenderMenu=function(){this.RenderRect("#ff8800",0,0,this.canvas.width,this.canvas.height),this.drawFromTexture(texture.menu,0,0,16,19,0,0,64),this.drawFromTexture(texture.gui,0,8,16,16,4.4,1,29);for(var e=0;e<this.menu.buttons.length;e++)this.drawMenuButton(350+24*e*4,e==this.menu.selectedButton,this.menu.buttons[e].text)},Engine.drawFPS=function(){this.RenderText("#f8f8f8",parseInt(fps),25,50)},Engine.drawLoading=function(e){this.ctx.clearRect(0,0,1024,1024),this.RenderText("#f8f8f8",e,25,50),console.info(e)},Engine.drawMenuButton=function(e,t,i){var n=193,s=23,o=1==t?71:48,a=256-n,r=(256-n)/2*4;this.ctx.drawImage(texture.gui,a,o,n,s,r,e,4*n,4*s),this.RenderTextPixels("#f8f8f8",i,r+n/2,e+2.5*s)},Engine.drawDeathScrenn=function(){},Engine.drawToInventory=function(e,t){"undefined"!=typeof e.anim&&this.ctx.drawImage(texture.sprite,16*e.anim[0].x,16*e.anim[0].y,16,16,34+84*t-4*t,1132,64,64),this.ctx.drawImage(texture.sprite,16*e.x,16*e.y,16,16,34+84*t-4*t,1132,64,64)},Engine.drawPlayer=function(e,t){var i=MapObjects.ff0000;"undefined"==typeof this.player.animCount&&(this.player.animCount=0),this.player.animCount>=i.facing[this.facing].length&&(this.player.animCount=0),this.player.isWalking?this.ctx.drawImage(texture.sprite,16*i.facing[this.facing][this.player.animCount].x,16*i.facing[this.facing][this.player.animCount].y,16,16,64*e,64*t,64,64):this.ctx.drawImage(texture.sprite,16*i.facing[this.facing][this.player.animCount].x,16*i.facing[this.facing][this.player.animCount].y,16,16,64*e,64*t,64,64),0==this.count&&this.player.animCount++},Engine.drawFromSprite=function(e,t,i){this.ctx.drawImage(texture.sprite,16*e.x,16*e.y,16,16,64*t,64*i,64,64)},Engine.drawFromTexture=function(e,t,i,n,s,o,a,r){this.ctx.drawImage(e,16*t,16*i,16*n,16*s,64*o,64*a,n*r,s*r)},Engine.drawFromAnimSprite=function(e,t,i){"undefined"!=typeof e&&this.ctx.drawImage(texture.sprite,16*e.x,16*e.y,16,16,64*t,64*i,64,64)},Engine.moveRngBlock=function(e){this.moveBlockDirection(e,rng(0,3))},Engine.moveBlockDirection=function(e,t){var i=e.x,n=e.y;0==t&&--i,1==t&&--n,2==t&&++i,3==t&&++n;var s=this.fullMap[i][n];s.block_id.solid||"undefined"!=typeof s.block_id&&s.block_id===MapObjects.ffffff&&this.switchBlock(e,s)},Engine.switchBlock=function(e,t){},Engine.loadNextMap=function(){this.currentMapNr=Maps[this.currentMapNr].next,this.fog=Maps[this.currentMapNr].fog,this.invetory=[],this.LoadNewMap(Maps[this.currentMapNr].file)},Engine.MapGoLevelDown=function(){return Maps[this.currentMapNr].levels.length>=0?!1:(this.currentMapNr=Maps[this.currentMapNr].levels[Maps[this.currentMapNr].currentLevel-1],void this.LoadNewMap(Maps[this.currentMapNr]))},Engine.MapGoLevelUp=function(){return Maps[this.currentMapNr].levels.length<=Maps[this.currentMapNr].levels.length?!1:(this.currentMapNr=Maps[this.currentMapNr].levels[Maps[this.currentMapNr].currentLevel+1],void this.LoadNewMap(Maps[this.currentMapNr]))},Engine.LoadNewMap=function(e){this.CurrentMap=this.Open(e)},Engine.walk=function(e,t,i){return pressedKeys[e]?this.facing!==t?void(this.facing=t):void this.walkDir(t,i):void 0},Engine.walkDir=function(e,t){var i=this.GetPlayerCords(),n=Number(this.player.x),s=Number(this.player.y),o=!0;0==e&&(--i.x,n-=t),1==e&&(--i.y,s-=t),2==e&&(++i.x,n+=t),3==e&&(i.y=Math.floor(i.y),++i.y,s+=t),this.fullMap[i.x][i.y].block_id.solid&&(o=!1);var a=2*t;!o&&i.y-1>s&&3==e&&(o=!0),!o&&i.y+.7<s+a&&1==e&&(o=!0),!o&&i.x-.5>n+a&&2==e&&(o=!0),!o&&i.x+.5<n-a&&0==e&&(o=!0),o&&(0!=e&&2!=e||(this.player.x=n),1!=e&&3!=e||(this.player.y=s),this.player.isWalking=!0,updatePosition(this.GetPlayerCords().x,this.GetPlayerCords().y,!0)),this.player.isWalking=!1,updatePosition(this.GetPlayerCords().x,this.GetPlayerCords().y,!0)},Engine.GetPlayerCords=function(){var e=Math.round(this.player.x),t=Math.round(this.player.y);return{x:e,y:t}},Engine.GetPlayerCordsFloor=function(){var e=Math.floor(this.player.x),t=Math.floor(this.player.y);return{x:e,y:t}},Engine.GetPlayerCordsCeil=function(){var e=Math.ceil(this.player.x),t=Math.ceil(this.player.y);return{x:e,y:t}},Engine.addToInvetory=function(e){return this.invetory.length>=10?!1:(this.invetory.push(e),!0)},Engine.changeInvetoryItem=function(e){return"undefined"==typeof this.invetory[this.selectedInvetorySlot]?!1:(this.invetory[this.selectedInvetorySlot]=e,!0)},Engine.removeSelectedInvetoryitem=function(){this.invetory.splice(this.selectedInvetorySlot,1)},Engine.init();var Maps=[{name:"level 1",file:texture.map1,next:1,fog:10,startLevel:0,currentLevel:0,levels:[texture.map1,texture.map2]},{name:"level 2",file:texture.map2,next:2,fog:8},{name:"level 3",file:texture.map3,next:0,fog:6},{name:"Kjetil bane",file:texture.map4,next:0,fog:6},{name:"Testing Map",file:texture.testMap,next:0,fog:30}],ItemsList={};for(var item in MapObjects)if(MapObjects.hasOwnProperty(item)){var id=MapObjects[item].name.toLowerCase();ItemsList[id]=MapObjects[item],ItemsList[id].uuid=item}
//# sourceMappingURL=./main-min.js.map